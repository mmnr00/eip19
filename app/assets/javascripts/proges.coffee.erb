
updateTable = (data) ->
  $('#proge-table tbody').append """
    <tr>
      <td>#{data.name}</td>
      <td>#{data.ic}</td>
    </tr>
  """
  return

$ ->
  $('#add-perse').on 'ajax:complete', (data) ->
    $('#add-perse')[0].reset()
    updateTable data.detail[0]
    pusher = new Pusher('<%= ENV["PUSHER_KEY"] %>',
    cluster: '<%= ENV["PUSHER_CLUSTER"] %>'
    encrypted: true)
  channel = pusher.subscribe('perse')
  channel.bind 'new', (data) ->
    updateTable data
    return
  return

