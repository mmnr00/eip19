<div class="card mb-3">
  <div class="card-header" style="background-color:#7f7fff">
    <h3 align="center" style="color:white"> 
      REPORTING FOR <%= @course.name %> IN <%= @course.college.name %>
  </div>
</div>

<div class="row">
  <!-- ATTENDANCE SUMMARY -->
  <div class="col-md-4 bg-white">
    <br><h4 align="center">ATTENDANCE SUMMARY</h4>
    <h6 align="center">
      <%= "#{@attendance["ATTEND"]} OUT OF #{@attendance.count} ATTENDED" %>
    </h6>
    <%= pie_chart @attendance, colors: ["#66b266","#ff6666"], donut: true, legend: false, thousands: "," %><br>
  </div>
  <!-- ATTENDANCE LIST -->
  <div class="col-md-5 bg-white"><br>
    <div class="card ">
      <div class="card-header">
        ATTENDANCE LIST
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped table-bordered" width="100%" cellspacing="0">
            <thead>
              <tr>
                <th style="background-color:#d8b2d8"> NAME </th>
                <th style="background-color:#d8b2d8"> ATTENDANCE </th>
                <th style="background-color:#d8b2d8"> FEEDBACK </th>
              </tr>
            </thead>
            <tbody>
              <% @tchdetails.each do |tch| %>
              <tr>
                <td><%= tch.name %></td>
                <td>
                  <% if Anisatt.where(course_id: @course.id).where(tchdetail_id: tch.id).where(att: true).present? %>
                    <%= link_to "ATTEND", "#", class: "btn btn-sm btn-success active" %>
                  <% else %>
                    <%= link_to "ABSENT","#",class: "btn btn-sm btn-danger active" %>
                  <% end %>
                </td>
                <td>
                  <% if tch.anisfeeds.where(course_id: @course.id).present? %>
                    YES
                  <% else %>
                    NO
                  <% end %>
                </td>

              </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-- RATING -->
  <div class="col-md-3 bg-white"><br>
    <h4 align="center"> OVERALL RATING </h4><br>
    <h1 align="center"><font color="orange"><i class="fa fa-star" style="font-size:200px"></i></font></h1>
    <h2 align="center">
      <%= number_with_precision(@anisfeed.average(:rate), :precision => 2) %>
    </h2>
  </div>

</div><br>

<div class="col-md-12">
  <!-- GOOD BAD -->
  <div class="card ">
    <div class="card-header">
      OVERALL REVIEWS
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-bordered" width="100%" cellspacing="0">
          <thead>
            <tr>
              <th style="background-color:#d8b2d8"> WHAT DO PEOPLE LIKE </th>
              <th style="background-color:#d8b2d8"> WHAT NEEDS TO BE IMPROVE</th>
            </tr>
          </thead>
          <tbody>
            <% @anisfeed.each do |feed| %>
            <tr>
              <td><%= feed.good %></td>
              <td><%= feed.bad %></td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div><br>

<div class="col-md-12">
  <div class="card ">
    <div class="card-header">
      PROGRAMME REVIEWS
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-bordered" width="100%" cellspacing="0">
          <thead>
            <tr>
              <th style="background-color:#d8b2d8"> NAME </th>
              <th style="background-color:#d8b2d8"> LECTURER </th>
              <th style="background-color:#d8b2d8"> RATING </th>
              <th style="background-color:#d8b2d8"> REVIEWS </th>
            </tr>
          </thead>
          <tbody>
            <% @anisprogs.each do |prog| %>
            <tr>
              <td><%= prog.name %></td>
              <td><%= prog.lec %></td>
              <td>
                <font color="orange"><i class="fa fa-star" style="font-size:30px"></i></font>
                &nbsp&nbsp<strong>
                  <%= number_with_precision(prog.feedbacks.average(:rating), :precision => 2) %>
                </strong>
              </td>
              <td>
                <% counter = 1 %>
                <% prog.feedbacks.each do |rev| %>
                  <%= counter %>. &nbsp<%= rev.review %><br><br>
                  <% counter = counter + 1 %>
                <% end %>
              </td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>